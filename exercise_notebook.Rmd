---
title: "Bioinformatics exercise"
output: html_notebook
---



```{r Setup phase, message=TRUE}

# Install Bioconductor
source("https://bioconductor.org/biocLite.R")
biocLite()

# Install edgeR
biocLite("edgeR")

```

```{r Raw data import}

# Import the raw dataset
sample_annotation <- read.delim("data/sample-annotation.txt")
gene_annotation <- read.delim("data/gene-annotation.txt")
counts <- read.delim("data/counts.txt")
```

```{r Exploratory analysis}

# explore the properties of the gene-annotation 
dim(gene_annotation)
summary(gene_annotation)
head(gene_annotation)


# the same for sample annotation
dim(sample_annotation)
head(sample_annotation)

# seems like categorical variable
table(sample_annotation$type)


# look at the count data-set, extract quantiles
dim(counts)
colnames(counts)[1] <- "ENSEMBL"


# now sure the annotation and counts are consistent
length(unique(counts$ENSEMBL))
length(unique(gene_annotation$ENSEMBL))
# it seems we have quite a lot of missing gene annotations
missing_annotations <- setdiff(unique(counts$ENSEMBL), unique(gene_annotation$ENSEMBL))
sprintf("The number of missing annotations %s out of %s", length(missing_annotations), length(unique(counts$ENSEMBL)))

# loot for missing sample metadata
length(unique(sample_annotation$sample_id))
length(unique(colnames(counts)[-1]))
setdiff(sample_annotation$sample_id, colnames(counts)[-1])
# we have complete pe-rsample metadata



count_qnt <- t(apply(counts[,-1], 1, quantile, probe = c(.25,.75), na.rm = FALSE))

# CPM gene
ens_id <- gene_annotation[which(gene_annotation$SYMBOL %in% "CPM"),]$ENSEMBL
cpm_values <- counts[which(counts$ENSEMBL %in% ens_id),]
count_qnt[which(counts$ENSEMBL %in% ens_id),]

```
